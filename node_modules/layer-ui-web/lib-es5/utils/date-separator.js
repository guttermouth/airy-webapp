/**
 * Use this module to put a date separator between Messages from different dates in your Messages List.
 *
 * ```
 * conversationPanel.onRenderListItem = layerUI.utils.dateSeparator;
 * ```
 *
 * Or if you have multiple `onRenderListItem` handlers:
 *
 * ```
 * conversationPanel.onRenderListItem = function(widget, messages, index, isTopItem) {
 *     layerUI.utils.dateSeparator(widget, messages, index);
 *     handler2(widget, messages, index, isTopItem);
 *     handler3(widget, messages, index, isTopItem);
 * }
 * ```
 *
 * Date separators come as `<div class='layer-list-item-separator-date'><span>DATE</span></div>`
 *
 * @class layerUI.utils.DateSeparator
 */
'use strict';

var _base = require('../base');

var _base2 = _interopRequireDefault(_base);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var dateClassName = 'layer-list-item-separator-date'; 


module.exports = _base.utils.dateSeparator = function (widget, messages, index) {
  if (index > messages.length) return;
  var message = widget.item;
  var needsBoundary = index === 0 || message.sentAt.toDateString() !== messages[index - 1].sentAt.toDateString();

  if (needsBoundary) {
    var options = { weekday: 'long', year: 'numeric', month: 'short', day: '2-digit' };
    var dateStr = messages[index].sentAt.toLocaleDateString(undefined, options);
    _base2.default.addListItemSeparator(widget, '<span>' + dateStr + '</span>', dateClassName, true);
  } else {
    _base2.default.addListItemSeparator(widget, '', dateClassName, true);
  }
};